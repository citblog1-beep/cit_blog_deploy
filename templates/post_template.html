{% extends "base.html" %}

{# Ø¹Ù†ÙˆØ§Ù† ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…ØªØµÙØ­ #}
{% block title %}{{ title }} - Ù…Ø¯ÙˆÙ†Ø© CIT{% endblock %}

{# ÙˆØµÙ Ù…ÙŠØªØ§ Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ù‚Ø§Ù„ #}
{% block meta_description %}
{{ title }} - Ù…Ù‚Ø§Ù„ Ø¶Ù…Ù† Ù‚Ø³Ù… {{ category_name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© CITØŒ Ø¨Ù…Ø­ØªÙˆÙ‰ ØªÙ‚Ù†ÙŠ Ù…Ø¨Ø³Ù‘Ø· ÙˆÙ…ÙÙŠØ¯ Ù„Ù„Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠ.
{% endblock %}

{# OG Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±Ø§Ø¨Ø· #}
{% block og_title %}{{ title }} - Ù…Ø¯ÙˆÙ†Ø© CIT{% endblock %}
{% block og_description %}
{{ title }} - Ù…Ù‚Ø§Ù„ Ù…Ù† Ù‚Ø³Ù… {{ category_name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© CITØŒ ÙŠÙ‚Ø¯Ù‘Ù… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªÙ‚Ù†ÙŠØ© ÙˆØ´Ø±ÙˆØ­Ø§Øª Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø³Ù‡Ù„Ø© ÙˆÙˆØ§Ø¶Ø­Ø©.
{% endblock %}

{# Twitter Cards #}
{% block twitter_title %}{{ title }} - Ù…Ø¯ÙˆÙ†Ø© CIT{% endblock %}
{% block twitter_description %}
Ù…Ù‚Ø§Ù„ Ø¨Ø¹Ù†ÙˆØ§Ù† "{{ title }}" Ù…Ù† Ù‚Ø³Ù… {{ category_name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© CITØŒ Ù„Ù…Ø­ØªÙˆÙ‰ ØªÙ‚Ù†ÙŠ Ù…Ø¨Ø³Ù‘Ø· Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.
{% endblock %}

{# JSON-LD Article #}
{% block jsonld %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": {{ title|tojson }},
  "inLanguage": "ar-SA",
  "articleSection": {{ category_name|tojson }},
  "url": {{ request.url|tojson }},
  "mainEntityOfPage": {{ request.url|tojson }},
  "author": {
    "@type": "Organization",
    "name": "CIT Blog"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CIT Blog"
  }
  {% if date and date != 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' %},
  "datePublished": {{ date|tojson }}
  {% endif %}
}
</script>
{% endblock %}

{% block content %}

<div class="article-wrapper post-page">

  <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù‚Ø§Ù„ -->
  <article class="article-card post-container">

    <!-- Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ù‚Ø§Ù„ + Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø³Ù… -->
    <header class="post-header">
      <div class="post-breadcrumb">
        <div class="breadcrumb-left">
          <span class="breadcrumb-label">Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§Ù„ Ø¶Ù…Ù† Ù‚Ø³Ù…:</span>
          <span class="category-chip">{{ category_name }}</span>
        </div>

        <a href="{{ url_for('dynamic_category', slug=category_slug) }}" class="back-pill">
          <span class="back-icon">â†©</span>
          <span class="back-label">Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ {{ category_name }}</span>
        </a>
      </div>

      <h1 class="article-title">{{ title }}</h1>

      <div class="meta-info">
        {# Ù†Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯ ÙØ¹Ù„Ø§Ù‹ #}
        {% if date %}
          <span>ğŸ“… {{ date }}</span>
        {% endif %}
        <span>ğŸ‘ï¸ {{ views }} Ù…Ø´Ø§Ù‡Ø¯Ø©</span>
      </div>
    </header>

    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù‚Ø§Ù„ -->
    <div class="article-content">
      {{ content|safe }}
    </div>
  </article>

  <!-- Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª -->
  <section class="comments-section" id="comments">
    <h3 class="comments-title">ğŸ’¬ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</h3>

    {% if comments and comments|length > 0 %}
      {% for comment in comments %}
        <div class="comment-card">
          <div class="comment-header">
            <span>{{ comment.name }}</span>
            <span class="comment-time">{{ comment.timestamp }}</span>
          </div>
          <p class="comment-text">{{ comment.comment }}</p>
        </div>
      {% endfor %}
    {% else %}
      <p class="comment-text">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯.</p>
    {% endif %}

    {% if session.get('logged_in') %}
      <form action="{{ url_for('add_comment', category=category_slug, filename=filename) }}"
            method="post"
            class="comment-form">
        <textarea name="comment"
                  placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§..."
                  required></textarea>
        <button type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚</button>
      </form>
    {% else %}
      <p class="comment-text">
        ğŸš« ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚.
        <a href="{{ url_for('auth_page') }}" class="btn-link">Ø¯Ø®ÙˆÙ„ / ØªØ³Ø¬ÙŠÙ„</a>
      </p>
    {% endif %}
  </section>

  <!-- Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ø´Ø§Ø¨Ù‡Ø© -->
  {% if related_posts and related_posts|length > 0 %}
    <section class="related-section">
      <h3>ğŸ“Œ Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ø´Ø§Ø¨Ù‡Ø© Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù‚Ø³Ù…</h3>
      <div class="related-grid">
        {% for post in related_posts %}
          <a href="{{ post.url }}" class="related-card">
            <h4>{{ post.title }}</h4>
          </a>
        {% endfor %}
      </div>
    </section>
  {% endif %}

  <!-- Ø§Ø³ØªÙƒØ´Ù Ø£Ù‚Ø³Ø§Ù… Ø£Ø®Ø±Ù‰ -->
  <section class="other-sections">
    <div class="other-card">
      <div class="other-header">
        <div class="other-icon">ğŸ§­</div>
        <div>
          <h4 class="other-title">Ø§Ø³ØªÙƒØ´Ù Ø£Ù‚Ø³Ø§Ù… Ø£Ø®Ø±Ù‰</h4>
          <p class="other-subtitle">Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø£Ù‚Ø³Ø§Ù… Ø£Ø®Ø±Ù‰ Ù…Ù† Ù…Ø¯ÙˆÙ†Ø© CIT</p>
        </div>
      </div>
      <div class="sections-list">
        <a href="{{ url_for('projects') }}" class="section-pill">
          <span class="section-pill-label"> Ø¨Ø±Ù…Ø¬ØªÙŠ</span>
        </a>
        <a href="{{ url_for('tutorials') }}" class="section-pill">
          <span class="section-pill-label"> Ø´Ø±ÙˆØ­Ø§ØªÙŠ</span>
        </a>
        <a href="{{ url_for('articles') }}" class="section-pill">
          <span class="section-pill-label"> Ù…Ù‚Ø§Ù„Ø§ØªÙŠ</span>
        </a>
      </div>
    </div>
  </section>

</div>

{% endblock %}
